"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createLegacyPlugin = void 0;
const withPlugins_1 = require("../withPlugins");
const withRunOnce_1 = require("../withRunOnce");
const withStaticPlugin_1 = require("../withStaticPlugin");
const camelize = (s) => s.replace(/-./g, x => x.toUpperCase()[1]);
function createLegacyPlugin({ packageName, fallback, }) {
    let withFallback;
    if (Array.isArray(fallback)) {
        withFallback = config => withPlugins_1.withPlugins(config, fallback);
    }
    else {
        withFallback = fallback;
    }
    const withUnknown = config => {
        return withStaticPlugin_1.withStaticPlugin(config, {
            _isLegacyPlugin: true,
            plugin: packageName,
            // If the static plugin isn't found, use the unversioned one.
            fallback: withRunOnce_1.createRunOncePlugin(withFallback, packageName),
        });
    };
    const methodName = camelize(`with-${packageName}`);
    if (methodName) {
        Object.defineProperty(withUnknown, 'name', {
            value: methodName,
        });
    }
    return withUnknown;
}
exports.createLegacyPlugin = createLegacyPlugin;
//# sourceMappingURL=createLegacyPlugin.js.map