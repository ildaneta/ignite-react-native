"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const resolve_from_1 = __importDefault(require("resolve-from"));
const GoogleMapsApiKey_1 = require("../../android/GoogleMapsApiKey");
const Permissions_1 = require("../../android/Permissions");
const Maps_1 = require("../../ios/Maps");
const createLegacyPlugin_1 = require("./createLegacyPlugin");
const LOCATION_USAGE = 'Allow $(PRODUCT_NAME) to access your location';
// Copied from expo-location package, this gets used when the
// user has react-native-maps installed but not expo-location.
const withDefaultLocationPermissions = config => {
    var _a;
    // Only add location permissions if react-native-maps is installed.
    if (((_a = config._internal) === null || _a === void 0 ? void 0 : _a.projectRoot) &&
        resolve_from_1.default.silent(config._internal.projectRoot, 'react-native-maps')) {
        if (!config.ios)
            config.ios = {};
        if (!config.ios.infoPlist)
            config.ios.infoPlist = {};
        config.ios.infoPlist.NSLocationWhenInUseUsageDescription =
            config.ios.infoPlist.NSLocationWhenInUseUsageDescription || LOCATION_USAGE;
        return Permissions_1.withPermissions(config, [
            'android.permission.ACCESS_COARSE_LOCATION',
            'android.permission.ACCESS_FINE_LOCATION',
        ]);
    }
    return config;
};
exports.default = createLegacyPlugin_1.createLegacyPlugin({
    packageName: 'react-native-maps',
    fallback: [GoogleMapsApiKey_1.withGoogleMapsApiKey, Maps_1.withMaps, withDefaultLocationPermissions],
});
//# sourceMappingURL=react-native-maps.js.map